function [chime,N,count,t,omega] =  chimeraSolver2(timestep,maxTime)
    format long g
    %N is the metros on a swing
    %all the parameters:
        N = 15;
        kappa =5;    %coupling of swings
        mu_m = 0.011;    %nonlinearity of metros
        mu_s = 0.00016;   %damping of swings
        thet0 = 0.33;
        freq = 160/60;       %freq of metros in Hz
        m=0.028;
        M=2.31;
        lbob=7.3*10^(-2)-2.2*freq*60*10^(-4);
        r_cm=abs(0.178*lbob-0.0121);
        I=1.29*10^(-5) + 5*10^(-3)*lbob^2;
        x0 = (m*r_cm/M);
%         
        omega = sqrt(M*x0*9.81/I);
        %omega=2*pi*freq;
        L = 0.22;      %length of swing (L)
        g=9.81;
        Omega = sqrt(g/L);   %frequency of swing = root(g\L)
        beta=((omega/Omega)^2)*(x0/L);
    time = 0:timestep:maxTime;
    count = length(time);
    init_chime=zeros(2*N+2,2);
    %init_chime(1:N,:)=thet0*(1/2-rand(N,2));
    
     
     %IC =[-0.10690781749127842,0.6400537770814128;0.17956214353836922,-1.0789405346798235];
     %init = [-0.6546581804868434, -0.09211355761541334;-0.6546581804868434, -0.09211355761541334;2.1217870007739483, 0.2771296047953938];
     %init_chime(1,:)= IC(1,:);
     %init_chime(3,:)= IC(2,:);
    IC(:,1,1)=[ 0.14157382,  0.2614215 , -0.29608024, -0.24948547, -0.07842186,-0.31545333,  0.06066683,  0.27495881,  0.32353985, -0.19375554,0.07076737,  0.12151782, -0.28229673,  0.14350184,  0.03906534]';
    IC(:,2,1)=[ 0.04105613, -0.22835415,  0.05830795, -0.20626723, -0.15800162,-0.21524905,  0.18515062,  0.05557701, -0.13233109, -0.31297807,-0.01390028,  0.28235838,  0.0213475 , -0.20703707, -0.04162385]';
% 
    IC(:,1,2)= [-0.15290063,  0.3241958 ,  0.1120836 , -0.11188795, -0.30505519,-0.28341886,  0.14095393, -0.11355424,  0.01730479, -0.09568901,-0.1053118 ,  0.22120414, -0.17687524, -0.2194714 , -0.26651887]';
    IC(:,2,2)=[ 0.04002332, -0.31970233, -0.22865928, -0.03622754, -0.28424214,0.26495288,  0.08682372, -0.27123935, -0.08321772,  0.03173398,-0.13748985, -0.12752627, -0.28184933, -0.19892204, -0.07679633]';
    
    IC(:,1,3)=[ 0.21701744,  0.18755557,  0.09966056, -0.28854996, -0.17635286,-0.01643674,  0.1727202 ,  0.0847469 , -0.08738345, -0.03049813,-0.12964068, -0.15500856, -0.09896353, -0.01853356, -0.10522117]';
    IC(:,2,3)=[-0.00344076, -0.0126174 , -0.18630836,  0.03061491, -0.12380928,-0.08615331,  0.24836217, -0.09624896,  0.06622524, -0.31083154,-0.25894798,  0.04698623,  0.2034848 , -0.30503579, -0.04303378]';

    IC(:,1,4)=[-0.25608729,  0.09047053,  0.09671974,  0.03058346, -0.07007772,-0.2251715 ,  0.0924076 , -0.13879626, -0.31291416,  0.04675506,-0.21283704,  0.27935477,  0.23249934,  0.17652559, -0.15843773]';
    IC(:,2,4)=[ 0.04660167,  0.20153208,  0.29906662, -0.09469651,  0.25854828,-0.2800025 , -0.13962833, -0.13480114,  0.17154096,  0.27852486,0.26370911,  0.24858714, -0.32204741,  0.16938723, -0.05016757]';

    IC(:,1,5)=[ 0.20390167,  0.24951419, -0.26826464,  0.2513322 , -0.06521685,-0.1472395 , -0.29960625,  0.15699906,  0.10392526, -0.02591696,0.18069027,  0.10559009,  0.11846373, -0.14896994,  0.19258071]';
    IC(:,2,5)=[ 0.01096508,  0.06217605,  0.29208454,  0.20445947,  0.26906981,0.22516534,  0.30244717, -0.05703924,  0.08187052, -0.12740978,0.08876159,  0.23601612,  0.03232899,  0.2630207 , -0.17012485]';
    
    IC(:,1,6)=[-0.28236782,  0.02272068,  0.16583858,  0.20703668, -0.03638689,0.31897969, -0.25031005, -0.20690587,  0.10063275, -0.08376842,0.08703523,  0.28748882, -0.21245525, -0.02141477, -0.06271233]';
    IC(:,2,6)=[ 0.27097263,  0.23329002, -0.05803481,  0.2827175 ,  0.23302832,0.23946649,  0.06657793,  0.31238389, -0.07159775,  0.02263875,-0.01246499, -0.19855326,  0.06315608, -0.22265275,  0.11808502]';

    IC(:,1,7)=[-0.05060081, -0.2054146 , -0.06674946,  0.03285679,  0.2026197 ,-0.03184899, -0.27685172,  0.0690691 ,  0.19276587,  0.03763812,-0.16118089,  0.20861508,  0.16564133,  0.16393983, -0.23569675]';
    IC(:,2,7)=[ 0.13071014, -0.19924909,  0.17357686, -0.22026212,  0.29915596,-0.32026914,  0.28966824,  0.24144697,  0.18708392,  0.14308114,-0.00368212, -0.28380399, -0.00924944,  0.00729014, -0.14110797]';

    IC(:,1,8)=[ 0.1070623 , -0.03246503, -0.28466685, -0.13138537,  0.05092291,0.21429089, -0.1394381 ,  0.04477643, -0.16074862, -0.05627805,-0.02095395, -0.1479139 ,  0.32072046, -0.19726982, -0.20698106]';
    IC(:,1,8)=[-0.28029995, -0.29186344, -0.32068636,  0.03183383,  0.23346458,-0.15516512, -0.27783551, -0.28181846, -0.15027134, -0.18853984,-0.04635679, -0.00600303,  0.21760392, -0.04373139, -0.0743389 ]';

    IC(:,1,9)=[ 0.30193901, -0.22791099,  0.25686854,  0.05015035,  0.07947688,0.01271234, -0.00403621, -0.10561666,  0.13115458,  0.09444678,-0.16631024,  0.14466168,  0.27436442,  0.25167074, -0.30699128]';
    IC(:,2,9)=[ 0.05734172,  0.28317239,  0.25334837, -0.17983101,  0.17483002,0.31991728, -0.17518918, -0.16270593,  0.08318364,  0.2243455 ,-0.07216568, -0.2861955 , -0.23550847, -0.07095959,  0.24982223]';

    IC(:,1,10)=[ 0.04646099, -0.14375112, -0.22678913,  0.07848184, -0.13759088,-0.06037901,  0.10562991,  0.19844441, -0.10766317, -0.25007225,0.25419647,  0.08081354,  0.29445089,  0.20517673,  0.27329605]';
    IC(:,2,10)=[ 0.26712177,  0.32415907, -0.09147037, -0.12900987,  0.04657682,0.19501185,  0.00856151,  0.30200478, -0.24431119, -0.02569469,-0.19062023, -0.2423523 , -0.31037919,  0.04990117,  0.08438664]';
    
    init_chime(1:N,:)=IC(1:N,:,1);
    %(X is the complete 2N+2 x 2 vector here)
    F_psi_phi_swings=@(t,X) X(:,2);                                     % returns the angular velocity of the object stored in  the second column of X **
    A_phi_psi=@(X) [sin(X(:,1))+ mu_m*X(:,2).*((X(:,1)/thet0).^2 - 1)]; % calculates the quantity A to simplify calculations**
    sum1Phi_Psi = @(X) sum(ones*(cos(X(:,1)).^2));                      % returns the sum of cos squares of the metronome angle. **
    sum2Phi_Psi = @(X) sum(ones*(A_phi_psi(X).*cos(X(:,1)) + sin(X(:,1)).*(X(:,2).^2))); % returns the numerator summation in the omega_x_dot calculation **
    omega_x_dot=@(t,X) [( -((Omega/omega)^2+(kappa/(omega^2)))*X(2*N+1,1) - mu_s*X(2*N+1,2) + (kappa/(omega^2))*X(2*N+2,1) + sum2Phi_Psi(X(1:N,:)))/(1-beta*sum1Phi_Psi(X(1:N,:)))];% returns the swing angular velocity of capital PHI **
    omega_y_dot=@(t,X) [( -((Omega/omega)^2+(kappa/(omega^2)))*X(2*N+2,1) - mu_s*X(2*N+2,2) + (kappa/(omega^2))*X(2*N+1,1) + sum2Phi_Psi(X(N+1:2*N,:)))/(1-beta*sum1Phi_Psi(X(N+1:2*N,:)))];%  returns the swing angular velocity of capital PSI **
    omega_phi_dot=@(t,X) [-A_phi_psi(X(1:N,:))-beta*cos(X(1:N,1)).*(omega_x_dot(t,X))];% returns the angular velocity of the metronomes in the phi population **
    omega_psi_dot=@(t,X) [-A_phi_psi(X(N+1:2*N,:))-beta*cos(X(N+1:2*N,1)).*(omega_y_dot(t,X))];%returns the angular velocity of the metronomes in the psi population**
    
    
    Y(:,:,1)=init_chime;
    t=[0];
    h=timestep;
    
    for i=2:count
        % all declared for fixing the dimensions of them.
        K1=zeros(2*N+2,2);
        K2=zeros(2*N+2,2);
        K3=zeros(2*N+2,2);
        K4=zeros(2*N+2,2);
        K12=zeros(2,1);
        K22=zeros(2,1);
        K32=zeros(2,1);
        K42=zeros(2,1);
        
        %first step of RK-4
        t(i)=t(i-1)+h;
        K11=F_psi_phi_swings(t(i-1),Y(:,:,i-1));
        K12(1)=omega_x_dot(t(i-1),Y(:,:,i-1));
        K12(2)=omega_y_dot(t(i-1),Y(:,:,i-1));
        K13=omega_phi_dot(t(i-1),Y(:,:,i-1));
        K14=omega_psi_dot(t(i-1),Y(:,:,i-1));
        K1=[K13;K14;K12];
        % all the first steps are cumulated in K1 to make the update of the
        % vectors easier. K1 is a 2*N+2 x 2 dimenstional vector
        K1=[K11,K1];
        
        K21=F_psi_phi_swings(t(i-1)+(h/2),Y(:,:,i-1)+(h/2)*K1);
        K22(1)=omega_x_dot(t(i-1),Y(:,:,i-1)+(h/2)*K1);
        K22(2)=omega_y_dot(t(i-1),Y(:,:,i-1)+(h/2)*K1);
        K23=omega_phi_dot(t(i-1)+(h/2),Y(:,:,i-1)+(h/2)*K1);
        K24=omega_psi_dot(t(i-1)+(h/2),Y(:,:,i-1)+(h/2)*K1);
        K2=[K23;K24;K22];
        
        K2=[K21,K2];
        
        K31=F_psi_phi_swings(t(i-1)+(h/2),Y(:,:,i-1)+(h/2)*K2);
        K32(1)=omega_x_dot(t(i-1),Y(:,:,i-1)+(h/2)*K2);
        K32(2)=omega_y_dot(t(i-1),Y(:,:,i-1)+(h/2)*K2);
        K33=omega_phi_dot(t(i-1)+(h/2),Y(:,:,i-1)+(h/2)*K2);
        K34=omega_psi_dot(t(i-1)+(h/2),Y(:,:,i-1)+(h/2)*K2);
        K3=[K33;K34;K32];
        K3=[K31,K3];
        
        K41=F_psi_phi_swings(t(i-1)+(h),Y(:,:,i-1)+(h)*K3);
        K42(1)=omega_x_dot(t(i-1),Y(:,:,i-1)+(h/2)*K3);
        K42(2)=omega_y_dot(t(i-1),Y(:,:,i-1)+(h/2)*K3);
        K43=omega_phi_dot(t(i-1)+(h),Y(:,:,i-1)+(h/2)*K3);
        K44=omega_psi_dot(t(i-1)+(h),Y(:,:,i-1)+(h/2)*K3);
        K4=[K43;K44;K42];
        K4=[K41,K4];
        
        %final update .
        Y(:,:,i)=Y(:,:,i-1)+(h/6)*(K1 + 2*K2+ 2*K3 +K4 );
        
    end
    chime=Y;
    
end

